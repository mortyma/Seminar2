	\documentclass[serif,professionalfonts]{beamer}

%\usepackage{pgfpages}
%\setbeameroption{show only notes}
%\setbeameroption{show notes on second screen=top}

\usetheme{Forcellini}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}

% Hermann Zapf Optima clone (wonderful sanserif font) -- URW Classico
%\renewcommand{\sfdefault}{uop}
%\renewcommand{\rmdefault}{ppl}
%\usepackage{eulervm}
%\usepackage[right]{eurosym}
%\usepackage{paralist}
%\usepackage{algorithm2e}

% professional tables
%\usepackage{booktabs}
%\usepackage{pdfpages}
%\usepackage{multirow}
%\usepackage{array}
%\usepackage{dcolumn}
%\usepackage{subfigure}
%\usepackage{epsdice}

\usepackage{fixltx2e}
\usepackage{microtype}

\usepackage{dot2texi}
\usepackage{readarray}
\usepackage{tikz}
\usetikzlibrary{calc} %for calculations in tikz commands
\usetikzlibrary{positioning}
\usetikzlibrary{arrows}
\usepackage{xxcolor}


\setbeamertemplate{navigation symbols}{}
\usepackage{hyperref}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{comment}
% description with short indentation
\setbeamersize{description width of=x}

% some math operators
%\DeclareMathOperator{\har}{H}
%\DeclareMathOperator{\E}{E}
%\DeclareMathOperator{\lag}{lag}
%\DeclareMathOperator{\var}{Var}
%\DeclareMathOperator{\mf}{\enspace .}
%\DeclareMathOperator{\mc}{\enspace ,}
%\newcommand{\eye}{\mathbb{I}}
%\newcommand{\Z}{\mathbb{Z}}
%\newcommand{\dom}{\{0,1\}^n}
%\newcommand{\reals}{\mathbb{R}}
%\newcommand{\nats}{\mathbb{N}}
%\newcommand{\deq}{\triangleq}
%\newcommand{\pd}{\cdot_p}
%\newcommand{\pp}{+_p}
%\newcommand{\pmn}{-_p}
%\newcommand{\ed}{\epsdice}
%\newcommand{\bled}{\epsdice[black]}
%\newcommand{\bitup}{\vspace*{-4mm}}
%\newcommand{\nospace}{\abovedisplayskip=0pt}

\setbeamertemplate{caption}
{
  \raggedright%
  \insertcaption\par%
}
\setbeamercolor{green}{fg=green}

%reduce font size of footnotes
%\let\oldfootnotesize\footnotesize
%\renewcommand*{\footnotesize}{\oldfootnotesize\tiny}

%
\newcommand\todo[1]{\textcolor{red}{(TODO: #1)}}
\newcommand\load{L_{\mathrm{max}}}
\newtheorem{claim}{Claim}
\newtheorem{assumption}{Assumption}
\newtheorem{invariant}{Invariant}

%---------------------------------------------------------------------
%Front matter
%---------------------------------------------------------------------
\title{The Power of Two Random Choices}
%\subtitle{ A follow up seminar to the "Parallel Algorithms" lecture}
\author[M. Kalany]{Martin Kalany}
\institute[TU Wien]
{
  Graduate student in Computer Science\\
  Vienna University of Technology\\
}
\date{\today}

\begin{comment}
\AtBeginSubsubsection[]
{
  \begin{frame}<beamer>
    \frametitle{Outline}
    \tableofcontents[subsubsectionstyle=show/shaded,currentsection,currentsubsection]
  \end{frame}
}

\AtBeginSubsection[]
{
  \begin{frame}<beamer>
    \frametitle{Outline}
    \tableofcontents[subsubsectionstyle=show/shaded,currentsection,currentsubsection]
  \end{frame}
}

\AtBeginSection[]
{
  \begin{frame}<beamer>
    \frametitle{Outline}
    \tableofcontents[subsubsectionstyle=show/shaded,currentsection,currentsubsection]
  \end{frame}
}
\end{comment}

%---------------------------------------------------------------------
% Create Color definition From Template
%---------------------------------------------------------------------
% #1 template name, 
% #2 foreground color name
% #3 background color name
\newcommand{\ccft}[3]{
\usebeamercolor{#1}
\definecolor{#2}{named}{fg}
\definecolor{#3}{named}{bg}
}
%get some colors from the scheme
\ccft{block body example}{examplefg}{examplebg} 

%---------------------------------------------------------------------
%parameters for balls into bins graphs
%---------------------------------------------------------------------
%scale factor
\newcommand\scalefac{0.55}
%diameter of balls
\newcommand\ballsize{5mm}
%number of bins
\newcommand\nrbins{6}
%space between ball and bin
\newcommand\padding{0.1*\ballsize}
%height of a bin
\newcommand\binheight{5*\balldiameter}
%width of a bin
\newcommand\binwidth{\balldiameter}
%gap from bin to bin
\newcommand\bingap{1.6*\balldiameter}
%color of balls
\tikzstyle{ballstyle} = [ball color=black!30!red]

%---------------------------------------------------------------------
%tikz styles and commands
%---------------------------------------------------------------------
\newcommand\balldiameter{2*\ballsize}

%arrow style
\tikzstyle{insert} = [
	thick,->,>=stealth'
]

%draw an arrow symbolizing a location
\newcommand\iA[2][0]{
	\path (\nbid) edge[insert, bend left=#1] (#2);
}
%bin style
\tikzstyle{topflat} = [
	minimum width=(\binwidth+2*\padding)*\scalefac, 
	minimum height=(\binheight+4*\padding)*\scalefac,
	append after command={
    		\pgfextra
        		\fill[fill=examplebg] 
        			(\tikzlastnode.north east) [rounded corners] |-
        			(\tikzlastnode.south)  -| 
        			(\tikzlastnode.west) [sharp corners] |- 
        			(\tikzlastnode.north) -- cycle;
	         \draw[rounded corners] 
	         	(\tikzlastnode.north east) |- 
	         	(\tikzlastnode.south) -| 
	         	(\tikzlastnode.north west);
    		\endpgfextra
    }
]    

%draw i'th bin
\newcommand\bin[1]{
	\path node[topflat, xshift=#1*\bingap*\scalefac, above, yshift=-\padding*\scalefac]  {};
}

%draw all bins
\newcommand\bins{
	\foreach \ibin in {1,...,\nrbins}
		\bin{\ibin};
}

%set a node at bin #1, position #2 with node id = #1+(#2-1)*6
\newcommand\setNode[2]{
	\draw let \n1 ={#1#2} in node[circle, minimum size = \ballsize](n\n1) at (#1*\bingap,#2*\balldiameter-\ballsize) {};
}

%create nodes for all possible balls
\newcommand\nodes{
	\foreach \i in {1,...,6}
		\foreach \j in {1,...,5}
			\setNode{\i}{\j};
}

%paint a ball in bin #1, position #2
\newcommand\ball[2]{
	\shade[ballstyle] (#1*\bingap,#2*\balldiameter-\ballsize) circle (\ballsize) {};
}

%paint a ball that is to be inserted
\newcommand\nbid{nb}
\newcommand\newball{
	\draw node[circle, minimum size = \ballsize](\nbid) at (0*\bingap,6*\balldiameter-\ballsize) {};
	\ball{0}{6};
}

%put #2 balls into bin 1 <= #1 <= 6
\newcommand\putinbin[2]{
	\ifnum #2 > 0
		\foreach \nrballs in {1,...,#2}
 			\ball{#1}{\nrballs};
 	\fi
}

%put balls into bins. #i: number of balls to put in i'th bin
\newcounter{index}
\newcommand\balls[1]{%
	\getargsC{#1}%
  	\setcounter{index}{0}%
  	\whiledo{\theindex < \narg}{%
    		\stepcounter{index}%
    		\putinbin{\theindex}{\csname arg\romannumeral\theindex\endcsname}%
  	}%
}

%draw balls and bins. #i: number of balls to put in i'th bin
\newcommand\bab[1]{%
	\bins
	\nodes
	\balls{#1}
}
%draw group seperator after bin #1
\newcommand\groupSep[1]{
	\draw[thick, color=red!40] let \n1={(#1+0.5)*\bingap} in (\n1,-\ballsize) -- (\n1,\binheight +\ballsize);
}

%---------------------------------------------------------------------
%document
%---------------------------------------------------------------------
% Structure:
% 30 min
% 5 min easy stuff (so that everyone understands)
% 5 min more advanced stuff 
% 15 min difficult stuff (the proof, either of the symmetric or asymmetric allocation scheme using the infamous assumption 1
% 5 min further results and wrap up
\begin{document}
\begin{frame}
  \titlepage
\end{frame}
\note{}

\section{Balls into bins}
\begin{frame}
\frametitle{The Problem}
\begin{exampleblock}{Balls-into-bins games}
Suppose we have $n$ initially empty bins and need to distribute $m \geq n$ balls among them, \alert{as evenly as possible}. 
\end{exampleblock}

\begin{exampleblock}{Definition}
We are interested in the \alert{maximum load $\load$}, i.e, how many balls are in the fullest bin?
\end{exampleblock}

\begin{exampleblock}{Definition}
Equivalently, we can look at the \alert{additive gap} $\delta$:
\begin{align*}
\delta = \load - \frac{m}{n}
\end{align*}
\end{exampleblock}
\end{frame}

\begin{frame}
\frametitle{Applications}
Applications:
\begin{itemize}
	\item Hashing
	\item Online load balancing
	\item Emulating PRAMs on DMMs
	\item Low congestion circuit routing
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Single choice}
\framesubtitle{A basic allocation scheme}
\begin{exampleblock}{Single choice strategy}
For each ball, choose one of the $n$ bins uniformly and independently at random.
\end{exampleblock}

\bigskip

\begin{center}
\begin{tikzpicture}[scale=\scalefac]
	\bab{2 1 4 2 3 0}
	\newball
	\iA[40]{n23};
\end{tikzpicture}
\end{center}
\end{frame}

\begin{frame}
\frametitle{Some definitions}

Since we deal with a \alert{randomized process}, we cannot give upper bounds for the maximum load $\load$ with absolute certainty. 

\begin{exampleblock}{Definition}
We say that an event $\mathcal E_n$ occurs \alert{with high probability} (w.h.p.) if $\Pr\left[\mathcal E_n \right] \geq 1 - n^{-\alpha}$ for some $\alpha > 0$.
\end{exampleblock}

\bigskip
\pause

%\begin{exampleblock}{Definition}
We distinguish:
\begin{itemize}
\item The \alert{lightly loaded} case: $m = n$
\item The \alert{heavily loaded} case:	 $m \in \omega(n\ln n)$
\end{itemize}
%\end{exampleblock}
\end{frame}

\begin{frame}
\frametitle{Single choice}
\framesubtitle{Upper bound for the maximum load}
\begin{theorem}[Raab and Steger, 1998]
When using the single choice strategy to distribute $m$ balls to $n$ bins, the maximum load will be, w.h.p.,
\begin{align*}
\load = 
	\begin{cases}
    \frac{\ln n}{\ln\ln n} + O(1)              & m = n \\
    \frac{m}{n} + \Theta\left(\sqrt{\frac{m\ln n}{n}} \right)              & m \in \omega(n \ln n)
    \end{cases}
\end{align*}
\end{theorem}
\end{frame}

%Table of contents at the start of each section
\begin{comment}
\AtBeginSection[]
{
  \begin{frame}
    \frametitle{Table of Contents}
    \tableofcontents[currentsection]
  \end{frame}
}
\end{comment}

\section{Allocation schemes}
\begin{frame}
\frametitle{Multiple choice strategies}

\begin{exampleblock}{Idea}
Put a ball into the \alert{least full} of $d\geq2$ randomly chosen bins.
\end{exampleblock}

\pause
\bigskip
We can distinguish placement algorithms by the way the $d$ \alert{bins are sampled}:
\begin{itemize}
\item Uniformly and independently
\item Non-unfiromly and independently
\item Non-uniformly and dependently
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Greedy}
\begin{exampleblock}{The Greedy algorithm}
\begin{enumerate}
\item For each ball, choose $d$ bins independently and uniformly at random. 
\item Put the ball into the least full bin.
\item In case a tie occurs, choose one of the $d$ bins arbitrarily.
\end{enumerate}
\end{exampleblock}

\begin{center}
\begin{tikzpicture}[scale=\scalefac]
	\bab{2 1 4 2 3 0}
	\newball
	\iA[25]{n13};
	\iA[20]{n35};
	\iA[35]{n44};
\end{tikzpicture}
\end{center}

\end{frame}

\begin{frame}
\frametitle{Greedy}
\begin{theorem}[Azar, Broder, Karlin and Upfal, 1999]
When using the \alert{Greedy} algorithm to distribute $m$ balls to $n$ bins, the maximum load will be (w.h.p.~and for all $m$): 
\begin{align*}
\load = \frac{m}{n} + \frac{\ln \ln n}{\ln d} + O(1) \quad .
\end{align*}
\end{theorem}
\pause
\medskip
Compared to the \alert{single choice} strategy, with 
\begin{align*}
\load = 
	\begin{cases}
    \frac{\ln n}{\ln\ln n} + O(1)              & m = n \\
    \frac{m}{n} + \Theta\left(\sqrt{\frac{m\ln n}{n}} \right)              & m \in \omega(n \ln n)
    \end{cases} \quad ,
\end{align*}
\alert{Greedy} with $d=2$:
\begin{itemize}
\item achieves an \alert{exponential decrease} of the additive gap $\delta$ and
\item $\delta$ does \alert{not depend on} the number of balls \alert{$m$} anymore.
\end{itemize}
\end{frame}

\begin{frame}[shrink]
\frametitle{Always-go-left}
\begin{exampleblock}{The Always-go-left algorithm}
\begin{enumerate}
\item Partition the $n$ bins into $d$ groups.
\item Assume a fixed ordering of the bins $b_i$, $1\leq i \leq n$.
\item Choose one bin from each group uniformly and independently.
\item Put the ball into the least full bin.
\item In case a tie occurs, put the ball into the leftmost bin (i.e., the bin with smallest index) among those with same minimal load.
\end{enumerate}
\end{exampleblock}

\begin{center}
\begin{tikzpicture}[scale=\scalefac]
	\bab{2 1 4 2 3 0}
	\newball
	\groupSep{2};
	\groupSep{4};
	\iA[25]{n13};
	\iA[35]{n43};
	\iA[30]{n54};	
\end{tikzpicture}
\end{center}

\end{frame}

\begin{frame}
\frametitle{Always-go-left}
\begin{theorem}[V\"ocking, 2003]
When using the \alert{Always-go-left} algorithm to distribute $m$ balls to $n$ bins, the maximum load will be  (w.h.p.~and for all $m$): 
\begin{align*}
\load = \frac{m}{n} + \frac{\ln \ln n}{d \ln \Phi_d} + O(1) \quad .
\end{align*}
\end{theorem}
\todo{$\Phi_d$ is undefined. I think a full definition only makes sense if we present the proof for Always-go-left.}

\bigskip
The combination of \alert{asymmetric tie breaking} and \alert{non-uniform} (and independent) sampling of the $d$ bins is crucial to achieve this upper bound.
\end{frame}

\begin{frame}
\frametitle{BiB Model}
We will assume a sequential, infinite, dynamic process.

\begin{description}
\item[\alert{Sequential:}] The balls arrive one after another.
\item[\alert{Infinite:}] Ball placements and deletions are given for an infinite time span.
\item[\alert{Dynamic:}] At each time step $t$, one ball is removed from the bins.
\begin{itemize}
\item An oblivious adversary provides a sequence $\sigma = \sigma_1 \sigma_2 \dots$, where $\sigma_t = (d_t, a_t)$.
\item $d_t$/$a_t$: ball to delete/add at time step t. \\
\item $\sigma$ is fixed in advance.
\end{itemize}
\end{description}
\end{frame}

\begin{frame}
\frametitle{Proof of either Greedy or Always-go-left}
\end{frame}

\begin{frame}
\frametitle{Conclusion}
\end{frame}

\begin{comment}
\section{Test}
\begin{frame}
\frametitle{Ignore the following}
\begin{tikzpicture}[scale=\scalefac]
	\bab{1 2 3 4 5 6}
\end{tikzpicture}
\end{frame}
\end{comment}

%\againframe{references}

\begin{frame}[allowframebreaks, label=references]
\frametitle<presentation>{References}    
\bibliographystyle{acm}
\nocite{*}
\setbeamertemplate{bibliography item}[text]
\bibliography{../sources}
\end{frame} 	

\end{document}

%  LocalWords: 
